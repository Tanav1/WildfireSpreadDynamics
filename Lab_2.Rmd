---
title: "LAB 1 - Assessing Voting Challenges"
author: "Tanav Thanjavuru, Simran Gill, Ozkan Meric Ozcan"
date: "2024-07-02"
output:
  bookdown::pdf_document2:
    toc: true
    number_sections: true
---


\newpage
\setcounter{page}{1}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, include=FALSE}
library(dplyr)
library(ggplot2)
library(corrplot)
library(hexbin)
library(gridExtra)
library(lmtest)
library(sandwich)
library(stargazer)

theme_set(theme_bw())
knitr::opts_chunk$set(echo = TRUE)
```

FFMC - The fine fuel moisture code, represents fuel moisture of forest litter fuels under the shade of a forest canopy. 
DMC - measures the average moisture content of loosely compacted organic layers in the forest floor.
DC - Drought Code, is a unitless numeric rating in the Candian Forest Fire Weather Index (FWI) system that measures the average moisture content of deep, compact organic layers in soil and litter. 
ISI - a numeric rating in the Fire Weather Index (FWI) system that estimates how quickly a wildland fire will spread after it starts
temp - in celsius degrees
RH - relative humidity in percentage
wind - wind speed in km/h
rain - outside rain mm/m2
area - the burned area of the forest: 0.00 to 1090.84 (this output variable is very skewed towards 0.0, thus it may make sense to model with the logarithm transform). [ha - Hectare (symbol ha) is the metric unit of area that equals a square with 100 m side (1 hm2) or 10,000 square meters]


Research question: "What is the relationship between Fine Fuel Moisture Code (FFMC) and Initial Spread Index (ISI) in understanding wildfire spread dynamics in the northeast region of Portugal" Can provide insight into fire behavior in terms of spread-ability to put in place appropriate public safety measures. 
```{r }

data <- read.csv("forestfires.csv")

# shape of the data 
head(data)
```

```{r }
# do any columns have null values 
print(colSums(is.na(data)))
```
```{r }
vars <- c("FFMC", "DMC", "DC", "ISI", "temp", "RH", "wind", "rain", "area")
cor_matrix <- cor(data[vars], use = "complete.obs")

corrplot(cor_matrix, type = "upper", order = "hclust",
         tl.col = "black", tl.srt = 45)

```
```{r }
ggplot(data, aes(x = FFMC, y = ISI)) +
  geom_point(alpha = 0.5) +  # scatter plot points with transparency
  geom_density_2d() +        # add 2D density contours
  theme_minimal()  
```
```{r }
ggplot(data, aes(x = FFMC, y = ISI)) +
  geom_hex() +               
  scale_fill_viridis_c() +   
  theme_minimal()     
```
```{r }
# Detect Outlier in Column 
detect_outlier <- function(x, threshold_multiplier = 4) {
  Q1 <- quantile(x, probs = 0.25)
  Q3 <- quantile(x, probs = 0.75)
  IQR <- Q3 - Q1
  outliers <- x > (Q3 + threshold_multiplier * IQR) | x < (Q1 - threshold_multiplier * IQR)
  outliers
}

# Remove Outlier Function 
remove_outlier <- function(dataframe, columns = names(dataframe)) {
  for (col in columns) {
    outliers <- detect_outlier(dataframe[[col]])
    dataframe <- dataframe[!outliers, ]
  }
  dataframe
}


cleaned_data <- remove_outlier(data, c('FFMC', 'ISI')) 

dim(cleaned_data)
```
```{r }
ggplot(cleaned_data, aes(x = FFMC, y = ISI)) +
  geom_hex() +               
  scale_fill_viridis_c() +   
  theme_minimal() 
```


